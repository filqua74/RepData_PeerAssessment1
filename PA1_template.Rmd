---
title: "Reproducible Research: Peer Assessment 1"
author: Filippo Quarta
output: 
html_document:
keep_md: true
---


## Loading and preprocessing the data
```{r}
library("plyr")
library("lubridate")
library("ggplot2")

options(digit=10)

fileName <- "activity"
fileNameZip <- paste(fileName,".zip",sep = "")
fileNameCsv <- paste(fileName,".csv", sep = "")
data <- NULL
if (file.exists(fileNameZip)) {
  unzip(fileNameZip)
  data <- read.csv(fileNameCsv)
} else {
  print("File is not present.")
}
data$date <- ymd(data$date)
dataComp <- data[complete.cases(data),]
```

## What is mean total number of steps taken per day?
```{r}
attach(dataComp)
tmp <- aggregate(steps, by=list(date), FUN=sum)
colnames(tmp) <- c("date","steps")
detach(dataComp)

avg <- mean(tmp$steps)
med <- median(tmp$steps)
hist(tmp$step,breaks = 50,xlab = "Steps")
```

**Mean Total Steps/Day** =`r format(avg,digits=10)`  
**Median Total Steps/Day**=`r format(med,digits=10)`

## What is the average daily activity pattern?
```{r}
attach(dataComp)
dap <- aggregate(steps, by=list(interval), FUN=mean)
detach(dataComp)
colnames(dap) <- c("interval","steps")
g1 <- ggplot(dap, aes(x=interval,y=steps))
g1 <- g1 + geom_line(color="blue")
plot(g1)
```

Interval with maximum steps in average:
```{r}
dap[dap$step==max(dap$step),"interval"]
```


## Imputing missing values

In the original data are present **`r sum(is.na(data$step))`** observations with null steps. Missing values are filled using the averaged steps for corresponding interval from Daily Activity Pattern.  

```{r}
dataFill <- data
dataFill <- join(dataFill, dap, by=c("interval"))
colnames(dataFill) <- c("steps","date","interval","steps1")
dataFill$steps <- ifelse(is.na(dataFill$steps), dataFill$steps1, dataFill$steps)
dataFill <- dataFill[,1:3]

attach(dataFill)
tmp <- aggregate(steps, by=list(date), FUN=sum)
colnames(tmp) <- c("date","steps")
detach(dataFill)

avg <- mean(tmp$steps)
med <- median(tmp$steps)
hist(tmp$step,breaks = 50,xlab = "Steps")
```

**Mean Total Steps/Day** =`r format(avg,digits=10)`  
**Median Total Steps/Day**=`r format(med,digits=10)`  

These values are different from the ones obtained without substituting NA values. Median and Mean of total steps per day are now equal.

## Are there differences in activity patterns between weekdays and weekends?
